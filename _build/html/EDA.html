
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>EDA &#8212; EDA Proyecto Deep Learning Postate Cancer</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'EDA';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Filtro y selección final de las imagenes" href="data_filter.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/uninortelogo.jpeg" class="logo__image only-light" alt="EDA Proyecto Deep Learning Postate Cancer - Home"/>
    <script>document.write(`<img src="_static/uninortelogo.jpeg" class="logo__image only-dark" alt="EDA Proyecto Deep Learning Postate Cancer - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introducción
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="contexto.html"><strong>Contextualización</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="data_filter.html"><strong>Filtro y selección final de las imagenes</strong></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>EDA</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FEDA.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/EDA.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>EDA</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subconjunto-de-datos-radboud"><strong>Subconjunto de datos: Radboud</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submuestreo"><strong>Submuestreo</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eda-de-imagenes"><strong>EDA de imagenes</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#caracterizacion-de-imagenes"><strong>Caracterización de imagenes</strong></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="eda">
<h1><strong>EDA</strong><a class="headerlink" href="#eda" title="Link to this heading">#</a></h1>
<p>El conjunto de datos proporcionados consta de dos grandes conjuntos, por un lado en una carpeta llamada <code class="docutils literal notranslate"><span class="pre">train_images</span></code> se encuentran todas las imagenes con las cuales mas adelante se buscará entrenar los distintos modelos de deep learning para la deteccion de cancer de prostata, además se tiene una carpeta titulada <code class="docutils literal notranslate"><span class="pre">train_label_mask</span></code> donde se encuentran las mascaras asociada a cada una de las imagen que se mencionaron anteriormente, por ultimo se tienen lo siguientes archivos <code class="docutils literal notranslate"><span class="pre">csv</span></code>.</p>
<ol class="arabic simple">
<li><p>sample_submission.csv</p></li>
<li><p>test.csv</p></li>
<li><p>train.csv</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">mcolors</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.image</span> <span class="k">as</span> <span class="nn">mpimg</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;C:/Users/fonta/OneDrive/Documentos/CDD/7. Septimo semetre/Deep learning/Proyecto/train.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>image_id</th>
      <th>data_provider</th>
      <th>isup_grade</th>
      <th>gleason_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0005f7aaab2800f6170c399693a96917</td>
      <td>karolinska</td>
      <td>0</td>
      <td>0+0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>000920ad0b612851f8e01bcc880d9b3d</td>
      <td>karolinska</td>
      <td>0</td>
      <td>0+0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0018ae58b01bdadc8e347995b69f99aa</td>
      <td>radboud</td>
      <td>4</td>
      <td>4+4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>001c62abd11fa4b57bf7a6c603a11bb9</td>
      <td>karolinska</td>
      <td>4</td>
      <td>4+4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>001d865e65ef5d2579c190a0e0350d8f</td>
      <td>karolinska</td>
      <td>0</td>
      <td>0+0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 10616 entries, 0 to 10615
Data columns (total 4 columns):
 #   Column         Non-Null Count  Dtype 
---  ------         --------------  ----- 
 0   image_id       10616 non-null  object
 1   data_provider  10616 non-null  object
 2   isup_grade     10616 non-null  int64 
 3   gleason_score  10616 non-null  object
dtypes: int64(1), object(3)
memory usage: 331.9+ KB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(10616, 4)
</pre></div>
</div>
</div>
</div>
<p>En el resumen anterior se puede apreciar que existen 4 columnas en el dataset, y un total de 10616 registros:</p>
<ul class="simple">
<li><p>image_id: Identificador único para cada una de las imagenes.</p></li>
<li><p>data_provider: Entidad que proporcionó las imagenes.</p></li>
<li><p>isup_grade: International Society of Urological Pathology grade.</p></li>
<li><p>gleason_score: Grado de Gleason.</p></li>
</ul>
<p>Veamos un pequeño descriptivo de cada una de estas variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">image_id</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>10616
</pre></div>
</div>
</div>
</div>
<p>Notese que cada uno de los id de las imagenes son únicos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">data_provider</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;karolinska&#39;, &#39;radboud&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Vemos que existen 2 únicos proveedores de datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>

<span class="n">data_counts</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;data_provider&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_counts</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#1E90FF&#39;</span><span class="p">,</span> <span class="s1">&#39;#104E8B&#39;</span><span class="p">]</span> 

<span class="n">plt</span><span class="o">.</span><span class="n">pie</span><span class="p">(</span><span class="n">data_counts</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">data_counts</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">autopct</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">%1.1f%%</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">wedgeprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;edgecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">})</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribución de registros por data_provider&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>data_provider
karolinska    5456
radboud       5160
Name: count, dtype: int64
</pre></div>
</div>
<img alt="_images/086fae2d91000c1322a0638fd327a6aec50b1da3fd19d5006c02817a99a38143.png" src="_images/086fae2d91000c1322a0638fd327a6aec50b1da3fd19d5006c02817a99a38143.png" />
</div>
</div>
<p>En el gráfico anterior se muestra la proporción de datos que fueron suministrados por cada uno de los 2 provedores, como se mencionó anteriormente, se tiene un total de 10.616 imagenes y por motivos de recursos computacionales nos vemos en la tarea de reducir la cantidad de datos con la que se trabajarán los modelos, por lo cual mas adelante se tomarán solo los datos provistos por radboud para entrenar los modelos, los que nos deja trabajando con el 49% de los datos totales aproximadamente (5.160).</p>
<p><strong>Nota:</strong> recordemos que para cada una de las imagenes, se tiene una mascara asociada que será utilizada para entrenar los modelos, es decir que al final estaremos trabajando con 5.160 imagenes y 5.160 mascaras.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;isup_grade&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;data_provider&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">palette</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">height</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> 
                <span class="s1">&#39;</span><span class="si">{:1.2f}</span><span class="s1">%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">height</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)),</span> 
                <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribución de ISUP Grade por Proveedor de Datos&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ISUP Grade&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cantidad de Registros&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/968575acf32a90a854ecabf9a94321be93c9f4d2ad216d4f75ddd69e0a30a99e.png" src="_images/968575acf32a90a854ecabf9a94321be93c9f4d2ad216d4f75ddd69e0a30a99e.png" />
</div>
</div>
<p>En la gráfica anterior se muestra otra de las razones por las cuales al final se trabajará con el subconjunto provisto por radboud, vemos que para esta variable se tiene un balance entre las clases del grado ISUP, lo cual nos ayudará al momento de entrenar los modelos.</p>
<section id="subconjunto-de-datos-radboud">
<h2><strong>Subconjunto de datos: Radboud</strong><a class="headerlink" href="#subconjunto-de-datos-radboud" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_rad</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;data_provider&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;radboud&#39;</span><span class="p">]</span>
<span class="n">data_rad</span><span class="o">=</span><span class="n">data_rad</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;data_provider&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data_rad</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>image_id</th>
      <th>isup_grade</th>
      <th>gleason_score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0018ae58b01bdadc8e347995b69f99aa</td>
      <td>4</td>
      <td>4+4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>004dd32d9cd167d9cc31c13b704498af</td>
      <td>1</td>
      <td>3+3</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0068d4c7529e34fd4c9da863ce01a161</td>
      <td>3</td>
      <td>4+3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>006f6aa35a78965c92fffd1fbd53a058</td>
      <td>3</td>
      <td>4+3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>007433133235efc27a39f11df6940829</td>
      <td>0</td>
      <td>negative</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_rad</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 5160 entries, 0 to 5159
Data columns (total 3 columns):
 #   Column         Non-Null Count  Dtype 
---  ------         --------------  ----- 
 0   image_id       5160 non-null   object
 1   isup_grade     5160 non-null   int64 
 2   gleason_score  5160 non-null   object
dtypes: int64(1), object(2)
memory usage: 121.1+ KB
</pre></div>
</div>
</div>
</div>
<p>Podemos notar que en este subconjunto de datos cuenta con las mismas variables que el conjunto de datos original, y tiene un totl de 5.160 registros.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>

<span class="c1"># Crear la figura y el gráfico de barras</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;gleason_score&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_rad</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#104E8B&quot;</span><span class="p">,</span> <span class="n">order</span> <span class="o">=</span> <span class="n">data_rad</span><span class="p">[</span><span class="s1">&#39;gleason_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Agregar los números sobre las barras</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">height</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">height</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> 
                <span class="s1">&#39;</span><span class="si">{:1.2f}</span><span class="s1">%&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">height</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)),</span> 
                <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># Títulos y etiquetas</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribución del Gleason Score para el proveedor Radboud&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Gleason Score&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Cantidad de Registros&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

<span class="c1"># Mostrar el gráfico</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8a866d43f15be81ca3c3be735237d98d4320039dc6b5e3533f47b9321dfc6003.png" src="_images/8a866d43f15be81ca3c3be735237d98d4320039dc6b5e3533f47b9321dfc6003.png" />
</div>
</div>
<p>En la gráfica se observa la distribución de las clases para la variable Gleason Score, donde se evidencia un desbalance en la cantidad de registros por categoría. En particular, las clases <code class="docutils literal notranslate"><span class="pre">5+3</span></code> y <code class="docutils literal notranslate"><span class="pre">3+5</span></code> presentan muy pocos casos, lo que indica que en esta muestra la frecuencia de cánceres agresivos es baja. De manera similar, los scores <code class="docutils literal notranslate"><span class="pre">5+4</span></code> y <code class="docutils literal notranslate"><span class="pre">5+5</span></code> que representan los canceres mas agresivos y estos también muestran una menor representación en comparación con otras categorías.</p>
</section>
<section id="submuestreo">
<h2><strong>Submuestreo</strong><a class="headerlink" href="#submuestreo" title="Link to this heading">#</a></h2>
<p>Como se mencionó anteriormente, la mayor limitante al momento de trabajar con imagenes, es la cantidad de recursos que se necesitan no solo para procesarlas si no tambien al momento de entrenar los modelos con las mismas, es por esta principal razón que para este estudio nos vimos en la tarea de tomar una muestra mas pequeña, la idea principal es escoger una muestra estratificada, es decir, una muestra donde se mantengan las proporciones para la variable <code class="docutils literal notranslate"><span class="pre">Gleason</span> <span class="pre">Score</span></code>, la explicación detallada de como se llevo a cabo el proceso se encuentra en el apartado de <code class="docutils literal notranslate"><span class="pre">Filtro</span> <span class="pre">y</span> <span class="pre">selección</span> <span class="pre">final</span> <span class="pre">de</span> <span class="pre">las</span> <span class="pre">imagenes</span></code>.</p>
</section>
<section id="eda-de-imagenes">
<h2><strong>EDA de imagenes</strong><a class="headerlink" href="#eda-de-imagenes" title="Link to this heading">#</a></h2>
<p>El Análisis Exploratorio de Datos (EDA) para imágenes es un paso fundamental en la construcción de modelos de visión por computadora y en este caso para tecnicas y modelos de deep learning, ya que permite comprender la distribución, calidad y características de las imágenes antes del entrenamiento. A través de técnicas como la visualización de ejemplos, el análisis de histograma de píxeles, la detección de ruido o anomalías y la evaluación del balance de clases, se pueden identificar posibles problemas que afecten el rendimiento del modelo. Además, el EDA ayuda a definir estrategias de preprocesamiento adecuadas, como normalización, aumento de datos o filtrado de imágenes defectuosas, optimizando así el desempeño del modelo y reduciendo el riesgo de sesgo o sobreajuste.</p>
<p>En esta sección abordaremos el análisis pertinente para las imagenes que hacen parte del conjunto de datos de Radboud.</p>
<p><strong>Carga de las imagenes</strong>: Para este ejercicio de exploración se tomarán como ejemplo un total de 12 imagen las cuales corresponden a 6 imagenes y a 6 mascaras respectivas a cada una de las imgagenes, cada imagen corresponde a uno de los grados del ISUP score.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Se escogen las primeras imagenes para cada ISUP score</span>
<span class="n">isup</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">id_isup</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">isup</span><span class="p">:</span>
    <span class="n">filtro</span> <span class="o">=</span> <span class="n">data_rad</span><span class="p">[</span><span class="n">data_rad</span><span class="p">[</span><span class="s1">&#39;isup_grade&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">k</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">filtro</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">id_isup</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filtro</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">data_isup</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">id_isup</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_isup</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            image_id  isup_grade gleason_score
4   007433133235efc27a39f11df6940829           0      negative
1   004dd32d9cd167d9cc31c13b704498af           1           3+3
11  00bbc1482301d16de3ff63238cfd0b34           2           3+4
2   0068d4c7529e34fd4c9da863ce01a161           3           4+3
0   0018ae58b01bdadc8e347995b69f99aa           4           4+4
7   00928370e2dfeb8a507667ef1d4efcbb           5           4+5
</pre></div>
</div>
</div>
</div>
<p>En el dataset anterior de encuentran los id de las imagenes de nuestro interés que en el paso siguiente nos ayudara a almacenar estas imagenes en una lista, ademas se encuentra tambien el <code class="docutils literal notranslate"><span class="pre">ISUP</span> <span class="pre">grade</span></code> y su respectivo <code class="docutils literal notranslate"><span class="pre">gleason</span> <span class="pre">score</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">isup_img</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">isup_mask</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">img_id</span> <span class="ow">in</span> <span class="n">data_isup</span><span class="p">[</span><span class="s1">&#39;image_id&#39;</span><span class="p">]:</span>
    <span class="c1"># Cargar imagen normal</span>
    <span class="n">ruta_imagen</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;C:/Users/fonta/OneDrive/Documentos/CDD/7. Septimo semetre/Deep learning/py_deeplearning/images_eda/</span><span class="si">{</span><span class="n">img_id</span><span class="si">}</span><span class="s2">.tiff&quot;</span>
    <span class="n">imagen</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ruta_imagen</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">IMREAD_UNCHANGED</span><span class="p">)</span>

    <span class="c1"># Cargar máscara</span>
    <span class="n">ruta_mascara</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;C:/Users/fonta/OneDrive/Documentos/CDD/7. Septimo semetre/Deep learning/py_deeplearning/images_eda/</span><span class="si">{</span><span class="n">img_id</span><span class="si">}</span><span class="s2">_mask.tiff&quot;</span>
    <span class="n">mascara</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">ruta_mascara</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">IMREAD_UNCHANGED</span><span class="p">)</span>
    
    <span class="n">isup_img</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imagen</span><span class="p">)</span>
    <span class="n">isup_mask</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mascara</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Imágenes cargadas: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">isup_img</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Máscaras cargadas: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">isup_mask</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Imágenes cargadas: 6
Máscaras cargadas: 6
</pre></div>
</div>
</div>
</div>
<p><strong>Visualización de imagen</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fila</span> <span class="o">=</span> <span class="n">data_rad</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">data_rad</span><span class="p">[</span><span class="s1">&#39;image_id&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;0018ae58b01bdadc8e347995b69f99aa&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">fila</span><span class="p">)</span>

<span class="n">imagen</span><span class="o">=</span><span class="n">isup_img</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="c1"># Rotar la imagen 90° en sentido antihorario</span>
<span class="n">imagen_rotada</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">imagen</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">ROTATE_90_COUNTERCLOCKWISE</span><span class="p">)</span>

<span class="c1"># Convertir de BGR a RGB</span>
<span class="n">imagen_rotada</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">imagen_rotada</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>

<span class="c1"># Mostrar la imagen rotada</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imagen_rotada</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>  <span class="c1"># Ocultar ejes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Imagen Rotada&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                           image_id  isup_grade gleason_score
0  0018ae58b01bdadc8e347995b69f99aa           4           4+4
</pre></div>
</div>
<img alt="_images/724333e35f13e2f8e627cfefa21e5e4a4b546cd45c74d78c5f753cf8de27fc7b.png" src="_images/724333e35f13e2f8e627cfefa21e5e4a4b546cd45c74d78c5f753cf8de27fc7b.png" />
</div>
</div>
<p>La imagen anterior hace parte del conjunto suministrados por Radboud, vemos que esta imagen tiene un gleason score de <code class="docutils literal notranslate"><span class="pre">4+4</span></code> lo que significa que en la  biopsia de prostata anterior se encuentra presente un cancer agresivo y se confirma puesto que el grado de ISUP es de <code class="docutils literal notranslate"><span class="pre">4</span></code>, a simple vista no es simple ver donde se encuentra el cancer, pero como se mencionó al inico de este estudio, el conjunto de datos de entrenamiento cuenta con unas mascaras las cuales nos permiten notar la presencia de cancer tanto a nosotros como al modelo que mas adelante se implementará.</p>
<p>La imagen se encuentra rotada 90 grados por motivos de mejor visualización.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imagen</span> <span class="o">=</span> <span class="n">isup_mask</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
<span class="n">imagen</span> <span class="o">=</span> <span class="n">imagen</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span> 

<span class="c1"># Verificar propiedades de la imagen</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Dimensiones de la imagen:&quot;</span><span class="p">,</span> <span class="n">imagen</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tipo de datos:&quot;</span><span class="p">,</span> <span class="n">imagen</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Valor mínimo:&quot;</span><span class="p">,</span> <span class="n">imagen</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Valor máximo:&quot;</span><span class="p">,</span> <span class="n">imagen</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Valores únicos:&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">imagen</span><span class="p">))</span>

<span class="c1"># Rotar la imagen 90° en sentido antihorario</span>
<span class="n">imagen_rotada</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">imagen</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">ROTATE_90_COUNTERCLOCKWISE</span><span class="p">)</span>

<span class="c1"># Definir la paleta de colores para las clases</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">([</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">])</span>

<span class="c1"># Mostrar la imagen con la paleta de colores</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imagen_rotada</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Máscara Rotada (Solo Canal Rojo)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Dimensiones de la imagen: (25344, 5888)
Tipo de datos: uint8
Valor mínimo: 0
Valor máximo: 4
Valores únicos: [0 1 2 4]
</pre></div>
</div>
<img alt="_images/14c0d0b40bb5059cf783ed12298a22386e108797072dd48f46587fbe0d158777.png" src="_images/14c0d0b40bb5059cf783ed12298a22386e108797072dd48f46587fbe0d158777.png" />
</div>
</div>
<p>En la imagen anterior se visualixa la mascara correspondiente a la biopsia que se presentó anteriormente, como podemos ver los valores únicos que se encuentran en la mascara son <code class="docutils literal notranslate"><span class="pre">0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">4</span></code>, lo que indica que las celulas que se encuentran en la biopsia corresponden a celulas de estas clases, que como se mencionó en el contexto es una escala que clasifica las celulas con respecto a su grado de cancer.</p>
<p><code class="docutils literal notranslate"><span class="pre">Importante:</span></code> la información de las mascaras se encuentra en el canal rojo de la imagen y se le agrega una paleta de colores para cada clase de las celulas, la mascara anterior en su mayoria es roja, porque existe mayor presencia de celulas cancerigenas, es decir de la clase 4.</p>
<p>A continuación veamos como se ven cada una biopsia que pertenecen a cada uno de los grados de <code class="docutils literal notranslate"><span class="pre">ISUP</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">isup_values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">data_isup</span> <span class="o">=</span> <span class="n">data_rad</span><span class="p">[</span><span class="n">data_rad</span><span class="p">[</span><span class="s1">&#39;isup_grade&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">isup_values</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;isup_grade&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># Crear la figura y los subplots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Recorrer los IDs de las imágenes</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_isup</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()):</span>
    <span class="n">img_id</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">image_id</span>
    <span class="n">isup_grade</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">isup_grade</span>

    <span class="n">imagen</span> <span class="o">=</span> <span class="n">isup_img</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># Rotar la imagen 90° en sentido antihorario</span>
    <span class="n">imagen_rotada</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">imagen</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">ROTATE_90_COUNTERCLOCKWISE</span><span class="p">)</span>
    
    <span class="c1"># Convertir de BGR a RGB</span>
    <span class="n">imagen_rotada</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">imagen_rotada</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>

    <span class="c1"># Seleccionar el subplot correspondiente</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imagen_rotada</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ISUP </span><span class="si">{</span><span class="n">isup_grade</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Ajustar el espacio entre subplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/76609c6d1f849e6093f0e51950f3c8f1c791637dd3bf457e876ac45715d6d287.png" src="_images/76609c6d1f849e6093f0e51950f3c8f1c791637dd3bf457e876ac45715d6d287.png" />
</div>
</div>
<p>Ahora veamos como se ven las mascaras para cada una de las biopsias anteriores.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmap</span> <span class="o">=</span> <span class="n">mcolors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">([</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Recorrer los IDs de las imágenes</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_isup</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()):</span>
    <span class="n">img_id</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">image_id</span>
    <span class="n">isup_grade</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">isup_grade</span>

    <span class="n">imagen</span> <span class="o">=</span> <span class="n">isup_mask</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># Extraer solo el canal rojo</span>
    <span class="n">imagen</span> <span class="o">=</span> <span class="n">imagen</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Rotar la imagen 90° en sentido antihorario</span>
    <span class="n">imagen_rotada</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">imagen</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">ROTATE_90_COUNTERCLOCKWISE</span><span class="p">)</span>

    <span class="c1"># Seleccionar el subplot correspondiente</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">3</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imagen_rotada</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ISUP </span><span class="si">{</span><span class="n">isup_grade</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Ajustar el espacio entre subplots</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bda616f439d86609de8db1b0fd28bd87258b2d8a7bef928ccb9d92ff3fdb7b8b.png" src="_images/bda616f439d86609de8db1b0fd28bd87258b2d8a7bef928ccb9d92ff3fdb7b8b.png" />
</div>
</div>
<p>En la imagen anterior donde se muestran las mascaras asociada a cada una de las biopsia anteriores, lo mas interesante es notar como a medida que aumenta el grado de <code class="docutils literal notranslate"><span class="pre">ISUP</span></code> el color en las imagenes se va intensificando, indicando que las celulas que hay en cada imagen van aumentando en su prescencia de cancer y el grado del cancer.</p>
<section id="caracterizacion-de-imagenes">
<h3><strong>Caracterización de imagenes</strong><a class="headerlink" href="#caracterizacion-de-imagenes" title="Link to this heading">#</a></h3>
<p>En esta sección veremos las caracteristicas mas importantes de las imagenes que mas adelante se usarán para entrenar los modelos mas adelante.</p>
<p>Iniciamnos conociendo la distribución del ancho, alto y el radio de las imagenes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_prop</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;image_id&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;width&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="p">[],</span>
    <span class="s2">&quot;aspect_ratio&quot;</span><span class="p">:</span> <span class="p">[]</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">imagen</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">isup_img</span><span class="p">):</span>
    <span class="c1"># Obtener dimensiones</span>
    <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">imagen</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Calcular relación de aspecto</span>
    <span class="n">aspect_ratio</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="n">height</span>

    <span class="nb">id</span><span class="o">=</span><span class="n">data_isup</span><span class="p">[</span><span class="s1">&#39;image_id&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># Guardar en el diccionario</span>
    <span class="n">img_prop</span><span class="p">[</span><span class="s2">&quot;image_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">img_prop</span><span class="p">[</span><span class="s2">&quot;width&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>
    <span class="n">img_prop</span><span class="p">[</span><span class="s2">&quot;height&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">height</span><span class="p">)</span>
    <span class="n">img_prop</span><span class="p">[</span><span class="s2">&quot;aspect_ratio&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aspect_ratio</span><span class="p">)</span>

<span class="c1"># Convertir a DataFrame</span>
<span class="n">image_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">img_prop</span><span class="p">)</span>

<span class="c1"># Mostrar algunas filas</span>
<span class="n">image_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>image_id</th>
      <th>width</th>
      <th>height</th>
      <th>aspect_ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>007433133235efc27a39f11df6940829</td>
      <td>9472</td>
      <td>24320</td>
      <td>0.389474</td>
    </tr>
    <tr>
      <th>1</th>
      <td>004dd32d9cd167d9cc31c13b704498af</td>
      <td>8192</td>
      <td>22528</td>
      <td>0.363636</td>
    </tr>
    <tr>
      <th>2</th>
      <td>00bbc1482301d16de3ff63238cfd0b34</td>
      <td>5120</td>
      <td>26624</td>
      <td>0.192308</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0068d4c7529e34fd4c9da863ce01a161</td>
      <td>6912</td>
      <td>10496</td>
      <td>0.658537</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0018ae58b01bdadc8e347995b69f99aa</td>
      <td>5888</td>
      <td>25344</td>
      <td>0.232323</td>
    </tr>
    <tr>
      <th>5</th>
      <td>00928370e2dfeb8a507667ef1d4efcbb</td>
      <td>10752</td>
      <td>36352</td>
      <td>0.295775</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imagen</span> <span class="o">=</span> <span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;DimensionPlot.png&quot;</span><span class="p">)</span>

<span class="c1"># Mostrar la imagen</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>  
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imagen</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>  <span class="c1"># Oculta los ejes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/fa99049384503c2d8af5d7d2a81540d214d57fa77309a01c7a256e2effefdb5c.png" src="_images/fa99049384503c2d8af5d7d2a81540d214d57fa77309a01c7a256e2effefdb5c.png" />
</div>
</div>
<p>Se observa que la mayoría de las imágenes tienen anchos entre 5,000 y 15,000 píxeles, con una distribución sesgada a la derecha y algunos valores extremos. La distribución de alturas presenta una forma bimodal, indicando la presencia de dos grupos principales de tamaños. En cuanto a la relación de aspecto, la mayoría de las imágenes tienen valores cercanos a 1, sugiriendo formatos cuadrados, mientras que pocas presentan relaciones de aspecto altas, lo que indica que imágenes extremadamente anchas son poco comunes. En general, el conjunto de imágenes es diverso en tamaño, pero con ciertas tendencias predominantes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imagen</span> <span class="o">=</span> <span class="n">mpimg</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;ColorChannelIntensity.png&quot;</span><span class="p">)</span>

<span class="c1"># Mostrar la imagen</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>  
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">imagen</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>  <span class="c1"># Oculta los ejes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/aa4be1e70446d96f4821bb142a152f6df1ad6c371b87bc636faa263e5e85c0b1.png" src="_images/aa4be1e70446d96f4821bb142a152f6df1ad6c371b87bc636faa263e5e85c0b1.png" />
</div>
</div>
<p>Las gráficas muestran la distribución de la intensidad media en los canales de color rojo, verde y azul de un conjunto de imágenes. En los tres casos, la distribución es asimétrica hacia la izquierda, con una mayor concentración de valores altos, lo que sugiere que predominan colores claros en las imágenes analizadas. El canal azul presenta una mayor acumulación en intensidades cercanas a 250, mientras que los canales rojo y verde muestran distribuciones más extendidas con picos alrededor de 240. Esto indica que los tonos azulados podrían ser más predominantes en la composición cromática de las imágenes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color_image</span> <span class="o">=</span> <span class="n">isup_img</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># Puedes cambiar el índice si quieres otra imagen</span>

<span class="c1"># Calcular histogramas de los tres canales (BGR)</span>
<span class="n">color_histograms</span> <span class="o">=</span> <span class="p">[</span><span class="n">cv2</span><span class="o">.</span><span class="n">calcHist</span><span class="p">([</span><span class="n">color_image</span><span class="p">],</span> <span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="mi">256</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Mostrar la imagen original</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">color_image</span><span class="p">,</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Imagen Original&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="c1"># Graficar histogramas de color</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">hist</span><span class="p">,</span> <span class="n">color</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">color_histograms</span><span class="p">,</span> <span class="n">colors</span><span class="p">):</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hist</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Canal </span><span class="si">{</span><span class="n">color</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Histogramas de Canales de Color&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Valor de Píxel&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/ab2345eacdccdb3e0a8680c53f217a3011c8304b6dd595917158d86b3d1d0b2e.png" src="_images/ab2345eacdccdb3e0a8680c53f217a3011c8304b6dd595917158d86b3d1d0b2e.png" />
</div>
</div>
<p>Según la información entregada por la figura aneterior, se muestra una predominancia de tonos rosados y rojos, lo que se refleja en el histograma con un pico alto en el canal R (rojo), indicando una gran presencia de colores claros o blancos en la imagen. Los canales G (verde) y B (azul) tienen frecuencias mucho menores, sugiriendo que la imagen tiene una dominancia rojiza, típica en imágenes histológicas y en este caso patológicas como lo son estas biopsias.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gray_image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">isup_img</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2GRAY</span><span class="p">)</span>

<span class="c1"># Calcular histograma en escala de grises</span>
<span class="n">gray_hist</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">calcHist</span><span class="p">([</span><span class="n">gray_image</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[</span><span class="mi">256</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Mostrar la imagen en escala de grises</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">gray_image</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Imagen en Escala de Grises&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="c1"># Graficar histograma en escala de grises</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gray_hist</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Escala de Grises&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Histograma en Escala de Grises&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Valor de Píxel&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/eb6cb7806dfea0fb0ddaf499def21ac1529367794574bcee240780f33a648271.png" src="_images/eb6cb7806dfea0fb0ddaf499def21ac1529367794574bcee240780f33a648271.png" />
</div>
</div>
<p>Como adición del analisis anterior, se entrega la imagen anterior donde se muestra un histograma en escala de grises complementa el análisis de la imagen anterior. Muestra que la mayoría de los píxeles tienen valores cercanos a 255, lo que indica una gran presencia de áreas blancas o casi blancas en la imagen. Esto sugiere que la imagen tiene un fondo claro con regiones más oscuras que representan las estructuras principales.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="data_filter.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Filtro y selección final de las imagenes</strong></p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subconjunto-de-datos-radboud"><strong>Subconjunto de datos: Radboud</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submuestreo"><strong>Submuestreo</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#eda-de-imagenes"><strong>EDA de imagenes</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#caracterizacion-de-imagenes"><strong>Caracterización de imagenes</strong></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Nicoll Fontalvo & Ricardo Watts
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>